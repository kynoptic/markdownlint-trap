#!/bin/sh
# Enhanced pre-commit hook with build artifact checking

echo "ğŸ” Running pre-commit checks..."

# Run lint-staged for staged file fixes
npx lint-staged

# Check if build artifacts need updating after linting fixes
echo "ğŸ”„ Checking if build artifacts need updating..."
if npm run build --silent 2>/dev/null; then
    # If build produces changes, we need to stage them
    if ! git diff --exit-code --quiet .markdownlint-rules/; then
        echo "ğŸ“¦ Build artifacts updated, staging changes..."
        git add .markdownlint-rules/
    fi
else
    echo "âŒ Build failed after linting fixes"
    exit 1
fi

echo "âœ… Pre-commit checks completed"
